(this["webpackJsonpfrigo-manager-react"]=this["webpackJsonpfrigo-manager-react"]||[]).push([[0],{57:function(e,t,c){},58:function(e,t,c){"use strict";c.r(t);var n=c(2),s=c.n(n),a=c(26),r=c.n(a),i=c(19),o=c(11),l=c(3),d=function(){return Object(l.jsxs)("header",{className:"entete",children:[Object(l.jsx)("div",{className:"bg-entete"}),Object(l.jsx)("h1",{className:"font-weight-light text-uppercase text-center",children:Object(l.jsx)("a",{className:"text-light",href:"/welcome",children:"Frigo Manager"})})]})},j=function(){return Object(l.jsxs)(n.Fragment,{children:[Object(l.jsx)("div",{className:"text-center mb-3",children:Object(l.jsx)(i.b,{to:"/login",children:Object(l.jsx)("button",{type:"button",className:"btn btn-primary",children:"Connexion"})})}),Object(l.jsx)("div",{className:"text-center",children:Object(l.jsx)(i.b,{to:"/signup",children:Object(l.jsx)("button",{type:"button",className:"btn btn-outline-secondary",children:"Inscription"})})})]})},u=c(30),b=c(10),m=c(40),p=c(29),h=(c(52),c(59),{apiKey:"AIzaSyB-WajfF4C7P9q1hyWrEIJYsVG7Bek_FJ4",authDomain:"frigo-manager-react.firebaseapp.com",databaseURL:"https://frigo-manager-react.firebaseio.com",projectId:"frigo-manager-react",storageBucket:"frigo-manager-react.appspot.com",messagingSenderId:"652200231828",appId:"1:652200231828:web:0174b2d1aa8e5874d08581"}),O=s.a.createContext(null),x=function e(){var t=this;Object(m.a)(this,e),this.signupUser=function(e,c){return t.auth.createUserWithEmailAndPassword(e,c)},this.loginUser=function(e,c){return t.auth.signInWithEmailAndPassword(e,c)},this.signoutUser=function(){return t.auth.signOut()},this.passwordReset=function(e){return t.auth.sendPasswordResetEmail(e)},this.user=function(e){return t.db.doc("users/".concat(e))},p.a.initializeApp(h),this.auth=p.a.auth(),this.db=p.a.firestore()},f=c(23),g=(c(55),c(62)),v=function(e){var t=e.userData,c=Object(n.useContext)(O),s=Object(n.useState)(!1),a=Object(b.a)(s,2),r=a[0],i=a[1];Object(n.useEffect)((function(){return r&&setTimeout((function(){return c.signoutUser()}),1e3)}),[r,c]);var o=t.pseudo?" (".concat(t.pseudo,")"):"",d=r?"D\xe9connexion...":"Connect\xe9".concat(o);return Object(l.jsx)(g.a,{className:"d-flex justify-content-end mt-n4 mb-3",children:Object(l.jsx)(g.a.Check,{onChange:function(e){return i(e.target.checked)},checked:r,type:"switch",label:d,id:"deconnexion",className:"pointer"})})},N=c(21),y=c(14),C=c(41),w=c(28),k=c(15),S=function(e){var t=e.id,c=e.name,s=e.date,a=e.recipe,r=e.opened,i=e.addProduct,o=e.modifyProduct,d=e.hideForm,j={name:c,date:s,recipe:a,opened:r},u=Object(n.useState)(j),m=Object(b.a)(u,2),p=m[0],h=m[1],O=p.name,x=p.date,f=p.recipe,g=p.opened,v=function(e){"radio"!==e.target.type?h(Object(y.a)(Object(y.a)({},p),{},Object(N.a)({},e.target.id,e.target.value))):h(Object(y.a)(Object(y.a)({},p),{},{opened:e.target.value}))},S=t?Object(l.jsx)("h2",{className:"mb-4",children:"Modifier un produit"}):Object(l.jsx)("h2",{className:"mb-4",children:"Ajouter un produit"}),F=Object(l.jsxs)("div",{className:"d-flex justify-content-between",children:[t?Object(l.jsxs)("button",{type:"submit",className:"btn btn-primary",children:[Object(l.jsx)(k.c,{})," Modifier"]}):Object(l.jsxs)("button",{type:"submit",className:"btn btn-primary",children:[Object(l.jsx)(w.a,{})," Ajouter"]}),Object(l.jsxs)("button",{type:"button",className:"btn btn-outline-secondary ml-2",onClick:d,children:[Object(l.jsx)(C.a,{})," Annuler"]})]});return Object(l.jsxs)(n.Fragment,{children:[S,Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t?o(t,O,x,f,g):i(O,x,f,g)},children:[Object(l.jsxs)("div",{className:"form-group",children:[Object(l.jsx)("label",{htmlFor:"name",children:"Nom"}),Object(l.jsx)("input",{className:"form-control",onChange:v,value:O,type:"text",id:"name",autoComplete:"off",maxLength:"20",placeholder:"Nom du produit",required:!0})]}),Object(l.jsxs)("div",{className:"form-group",children:[Object(l.jsx)("label",{htmlFor:"date",children:"DLC"}),Object(l.jsx)("input",{className:"form-control",onChange:v,value:x,type:"date",id:"date",autoComplete:"on",required:!0})]}),Object(l.jsxs)("div",{className:"form-group",children:[Object(l.jsx)("label",{htmlFor:"recipe",children:"Recette"}),Object(l.jsx)("input",{className:"form-control",onChange:v,value:f,type:"text",id:"recipe",autoComplete:"off",maxLength:"20",placeholder:"Nom de la recette"})]}),Object(l.jsxs)("div",{className:"mb-4",children:[Object(l.jsx)("p",{style:{display:"inline-block",marginBottom:".5rem"},children:"Entam\xe9"}),Object(l.jsxs)("div",{className:"d-flex justify-content-start",children:[Object(l.jsxs)("div",{className:"mr-4",children:[Object(l.jsx)("input",{className:"mr-2",onChange:v,value:"true",type:"radio",name:"opened",id:"opened",checked:"true"===g&&!0}),Object(l.jsx)("label",{className:"form-check-label",htmlFor:"opened",children:"Oui"})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("input",{className:"mr-2",onChange:v,value:"false",type:"radio",name:"opened",id:"closed",checked:"false"===g&&!0}),Object(l.jsx)("label",{className:"form-check-label",htmlFor:"closed",children:"Non"})]})]})]}),F]})]})},F=function(){var e=new Date,t=(e.getDate()<10?0:"")+e.getDate()+"/"+(e.getMonth()+1<10?0:"")+(e.getMonth()+1);return Object(l.jsxs)("div",{className:"my-4",children:["Date d'aujourd'hui : ",Object(l.jsx)("strong",{children:t})]})},P=c(36),D=function(e){var t=e.id,c=e.name,n=e.date,s=e.recipe,a=e.opened,r=e.showForm,i=e.deleteProduct,o=n.replace(/(\d{4})-(\d{2})-(\d{2})/g,"$3/$2"),d=Math.ceil((new Date(n)-new Date)/864e5),j="".concat(d," jr").concat("true"===a?" (entam\xe9)":""),u=d<0?"black":d<2?"red":d<4?"orange":"green",b="true"===a?Object(l.jsx)(k.b,{className:"mr-3 pointer",color:u,"data-for":"smileyTooltip","data-tip":j,"data-event":"click"}):d<0?Object(l.jsx)(k.d,{className:"mr-3 pointer",color:u,"data-for":"smileyTooltip","data-tip":j,"data-event":"click"}):d<4?Object(l.jsx)(k.e,{className:"mr-3 pointer",color:u,"data-for":"smileyTooltip","data-tip":j,"data-event":"click"}):Object(l.jsx)(k.f,{className:"mr-3 pointer",color:u,"data-for":"smileyTooltip","data-tip":j,"data-event":"click"});return Object(l.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(l.jsxs)("div",{children:[b,Object(l.jsx)(P.a,{id:"smileyTooltip",place:"top",effect:"solid",eventOff:"click",delayHide:1500}),Object(l.jsx)("span",{className:"mr-3",children:Object(l.jsx)("strong",{children:o})}),Object(l.jsx)("span",{className:"mr-3",children:c})]}),Object(l.jsxs)("div",{children:[s&&Object(l.jsx)(k.h,{className:"mr-3 pointer",color:"#6c757d","data-for":"recipeTooltip","data-tip":s,"data-event":"click"}),Object(l.jsx)(P.a,{id:"recipeTooltip",place:"top",effect:"solid",eventOff:"click",delayHide:1500}),Object(l.jsx)(k.c,{className:"mr-3 pointer",color:"#6c757d",onClick:function(){return r(t,c,n,s,a)}}),Object(l.jsx)(k.i,{className:"pointer",color:"#6c757d",onClick:function(){return i(t)}})]})]})},I=function(){return Object(l.jsx)("div",{className:"d-flex justify-content-center my-5",children:Object(l.jsxs)("div",{className:"lds-roller",children:[Object(l.jsx)("div",{}),Object(l.jsx)("div",{}),Object(l.jsx)("div",{}),Object(l.jsx)("div",{}),Object(l.jsx)("div",{}),Object(l.jsx)("div",{}),Object(l.jsx)("div",{}),Object(l.jsx)("div",{})]})})};f.a.configure({position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!1});var E=function(e){var t=Object(n.useContext)(O),c=Object(n.useState)(null),s=Object(b.a)(c,2),a=s[0],r=s[1],i=Object(n.useState)({}),o=Object(b.a)(i,2),d=o[0],j=o[1],m=Object(n.useState)(!1),p=Object(b.a)(m,2),h=p[0],x=p[1],g=Object(n.useState)([]),N=Object(b.a)(g,2),y=N[0],C=N[1],P=Object(n.useState)(!1),E=Object(b.a)(P,2),q=E[0],M=E[1],T=Object(n.useState)({name:"",date:"",recipe:"",opened:"false"}),A=Object(b.a)(T,2),B=A[0],U=A[1],z=Object(n.useState)(1),R=Object(b.a)(z,2),L=R[0],J=R[1],W=Object(n.useState)(null),H=Object(b.a)(W,2),V=H[0],$=H[1],_=Object(n.useState)(!1),G=Object(b.a)(_,2),K=G[0],Y=G[1],Q=B.name,X=B.date,Z=B.recipe,ee=B.opened;Object(n.useEffect)((function(){var c=t.auth.onAuthStateChanged((function(t){return t?r(t):e.history.push("/")}));return a&&t.user(a.uid).get().then((function(e){if(e&&e.exists){var t=e.data();j(t)}})).catch((function(e){return console.log(e)})),function(){return c()}}),[a,t,e.history]),Object(n.useEffect)((function(){d.listProducts&&C(d.listProducts),d.idProduct&&J(d.idProduct),d.pseudo&&!h&&(f.a.success("Bienvenue ".concat(d.pseudo)),x(!0))}),[d]),Object(n.useEffect)((function(){a&&t.user(a.uid).update({listProducts:y,idProduct:L}).then((function(){return console.log("Donn\xe9es de l'utilisateur mises \xe0 jour")})).catch((function(e){return console.error("Erreur de mise \xe0 jour des donn\xe9es de l'utilisateur : ",e)}))}),[y]);var te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"false";$(e),U({name:t,date:c,recipe:n,opened:s}),M(!0)},ce=function(e){var t=y.findIndex((function(t){return t.id===e})),c=Object(u.a)(y),n=c[t].name;c.splice(t,1),C(c),f.a.success("Suppression de ".concat(n))},ne=K&&Object(l.jsxs)("div",{className:"alert alert-danger mb-4",role:"alert",children:[Object(l.jsx)("p",{className:"h5 text-center mb-3",children:"Supprimer tous les produits ?"}),Object(l.jsxs)("div",{className:"row text-center",children:[Object(l.jsx)("div",{className:"col",children:Object(l.jsxs)("button",{type:"button",className:"btn btn-success btn-block",onClick:function(){return C([]),Y(!1),void f.a.success("Suppression de toute la liste")},children:[Object(l.jsx)(k.a,{})," Oui"]})}),Object(l.jsx)("div",{className:"col",children:Object(l.jsxs)("button",{type:"button",className:"btn btn-danger btn-block",onClick:function(){return Y(!1)},children:[Object(l.jsx)(k.i,{})," Non"]})})]})]}),se=Object(l.jsxs)("div",{className:"row",children:[Object(l.jsx)("div",{className:"col-6 col-sm-8 pr-2",children:Object(l.jsxs)("button",{type:"button",className:"btn btn-primary btn-block text-nowrap",onClick:function(){return te()},children:[Object(l.jsx)(w.a,{})," Ajouter"]})}),Object(l.jsx)("div",{className:"col-6 col-sm-4 pl-2",children:Object(l.jsxs)("button",{type:"button",className:"btn btn-outline-secondary btn-block text-nowrap",onClick:function(){return Y(!0)},disabled:!y.length,children:[Object(l.jsx)(k.g,{})," Tout effacer"]})})]}),ae=y.length?Object(l.jsx)("ul",{className:"list-group list-group-flush",children:y.sort((function(e,t){return new Date(e.date)-new Date(t.date)})).map((function(e){var t=e.id,c=e.name,n=e.date,s=e.recipe,a=e.opened;return Object(l.jsx)("li",{className:"list-group-item",children:Object(l.jsx)(D,{id:t,name:c,date:n,recipe:s,opened:a,showForm:te,deleteProduct:ce})},t)}))}):Object(l.jsx)("p",{className:"h5 text-muted text-center pt-3 mb-0",children:"Votre liste est vide !"});return a?Object(l.jsxs)(n.Fragment,{children:[Object(l.jsx)(v,{userData:d}),ne,q?Object(l.jsx)(S,{id:V,name:Q,date:X,recipe:Z,opened:ee,addProduct:function(e,t,c,n){var s={id:L,name:e,date:t,recipe:c,opened:n};C([].concat(Object(u.a)(y),[s])),J(L+1),M(!1),f.a.success("Ajout de ".concat(e))},modifyProduct:function(e,t,c,n,s){var a=y.findIndex((function(t){return t.id===e})),r=Object(u.a)(y);r[a]={id:e,name:t,date:c,recipe:n,opened:s},C(r),M(!1),f.a.success("Modification de ".concat(t))},hideForm:function(){return M(!1)}}):Object(l.jsxs)(n.Fragment,{children:[se,Object(l.jsx)(F,{}),ae]})]}):Object(l.jsx)(I,{})},q=function(e){var t=Object(n.useContext)(O),c={email:"",password:""},s=Object(n.useState)(c),a=Object(b.a)(s,2),r=a[0],o=a[1],d=Object(n.useState)(""),j=Object(b.a)(d,2),u=j[0],m=j[1],p=r.email,h=r.password,x=function(e){return o(Object(y.a)(Object(y.a)({},r),{},Object(N.a)({},e.target.id,e.target.value)))},f=!p||h.length<6?Object(l.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:!0,children:"Connexion"}):Object(l.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Connexion"}),g=u&&Object(l.jsx)("div",{className:"alert alert-danger mb-4",role:"alert",children:u.message});return Object(l.jsxs)(n.Fragment,{children:[g,Object(l.jsx)("h2",{className:"mb-4",children:"Connexion"}),Object(l.jsxs)("form",{onSubmit:function(n){n.preventDefault(),t.loginUser(p,h).then((function(){o(Object(y.a)({},c)),e.history.push("/welcome")})).catch((function(e){m(e),o(Object(y.a)({},c))}))},children:[Object(l.jsxs)("div",{className:"form-group",children:[Object(l.jsx)("label",{htmlFor:"email",children:"Email"}),Object(l.jsx)("input",{className:"form-control",onChange:x,value:p,type:"email",id:"email",autoComplete:"off",required:!0})]}),Object(l.jsxs)("div",{className:"mb-4",children:[Object(l.jsx)("label",{htmlFor:"password",children:"Mot de passe"}),Object(l.jsx)("input",{className:"form-control",onChange:x,value:h,type:"password",id:"password",autoComplete:"off",required:!0})]}),f]}),Object(l.jsx)("div",{className:"mt-5",children:Object(l.jsx)(i.b,{to:"/signup",children:"Pas encore de compte ? Inscrivez-vous."})}),Object(l.jsx)("div",{children:Object(l.jsx)(i.b,{to:"/forgetpassword",children:"Mot de passe oubli\xe9 ? R\xe9cup\xe9rez-le."})})]})},M=function(e){var t=Object(n.useContext)(O),c={pseudo:"",email:"",password:"",confirmPassword:""},s=Object(n.useState)(c),a=Object(b.a)(s,2),r=a[0],o=a[1],d=Object(n.useState)(""),j=Object(b.a)(d,2),u=j[0],m=j[1],p=r.pseudo,h=r.email,x=r.password,f=r.confirmPassword,g=function(e){return o(Object(y.a)(Object(y.a)({},r),{},Object(N.a)({},e.target.id,e.target.value)))},v=p&&h&&x&&x===f?Object(l.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Inscription"}):Object(l.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:!0,children:"Inscription"}),C=u&&Object(l.jsx)("div",{className:"alert alert-danger mb-4",role:"alert",children:u.message});return Object(l.jsxs)(n.Fragment,{children:[C,Object(l.jsx)("h2",{className:"mb-4",children:"Inscription"}),Object(l.jsxs)("form",{onSubmit:function(n){n.preventDefault(),t.signupUser(h,x).then((function(e){return t.user(e.user.uid).set({pseudo:p,email:h,listProducts:[],idProduct:0})})).then((function(){o(Object(y.a)({},c)),e.history.push("/welcome")})).catch((function(e){m(e),o(Object(y.a)({},c))}))},children:[Object(l.jsxs)("div",{className:"form-group",children:[Object(l.jsx)("label",{htmlFor:"pseudo",children:"Pseudo"}),Object(l.jsx)("input",{className:"form-control",onChange:g,value:p,type:"text",id:"pseudo",autoComplete:"off",required:!0})]}),Object(l.jsxs)("div",{className:"form-group",children:[Object(l.jsx)("label",{htmlFor:"email",children:"Email"}),Object(l.jsx)("input",{className:"form-control",onChange:g,value:h,type:"email",id:"email",autoComplete:"off",required:!0})]}),Object(l.jsxs)("div",{className:"form-group",children:[Object(l.jsx)("label",{htmlFor:"password",children:"Mot de passe"}),Object(l.jsx)("input",{className:"form-control",onChange:g,value:x,type:"password",id:"password",autoComplete:"off",required:!0})]}),Object(l.jsxs)("div",{className:"mb-4",children:[Object(l.jsx)("label",{htmlFor:"confirmPassword",children:"Confirmer le mot de passe"}),Object(l.jsx)("input",{className:"form-control",onChange:g,value:f,type:"password",id:"confirmPassword",autoComplete:"off",required:!0})]}),v]}),Object(l.jsx)("div",{className:"mt-5",children:Object(l.jsx)(i.b,{to:"/login",children:"D\xe9j\xe0 inscrit ? Connectez-vous."})})]})},T=function(){return Object(l.jsx)("div",{children:"Oups, cette page n'existe pas !"})},A=function(e){var t=Object(n.useContext)(O),c=Object(n.useState)(""),s=Object(b.a)(c,2),a=s[0],r=s[1],o=Object(n.useState)(null),d=Object(b.a)(o,2),j=d[0],u=d[1],m=Object(n.useState)(null),p=Object(b.a)(m,2),h=p[0],x=p[1],f=j&&Object(l.jsx)("div",{className:"alert alert-success mb-4",role:"alert",children:j}),g=h&&Object(l.jsx)("div",{className:"alert alert-danger mb-4",role:"alert",children:h}),v=!a;return Object(l.jsxs)("div",{children:[f,g,Object(l.jsx)("h2",{className:"mb-4",children:"Mot de passe oubli\xe9"}),Object(l.jsxs)("form",{onSubmit:function(c){c.preventDefault(),t.passwordReset(a).then((function(){r(""),x(null),u("Consultez votre email ".concat(a," pour changer le mot de passe.")),setTimeout((function(){return e.history.push("/login")}),5e3)})).catch((function(e){r(""),x(e)}))},children:[Object(l.jsxs)("div",{className:"mb-4",children:[Object(l.jsx)("label",{htmlFor:"email",children:"Email"}),Object(l.jsx)("input",{className:"form-control",onChange:function(e){return r(e.target.value)},value:a,type:"email",id:"email",autoComplete:"off",required:!0})]}),Object(l.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:v,children:"R\xe9cup\xe9rer"})]}),Object(l.jsx)("div",{className:"mt-5",children:Object(l.jsx)(i.b,{to:"/login",children:"D\xe9j\xe0 inscrit ? Connectez-vous."})})]})},B=c(42),U=function(){return Object(l.jsx)("footer",{className:"row p-3 bg-dark",children:Object(l.jsx)("div",{className:"col",children:Object(l.jsxs)("p",{className:"text-light text-center mb-0",children:["Fait avec ",Object(l.jsx)(B.a,{color:"#ff002d"})," par ",Object(l.jsx)("a",{className:"font-weight-bold text-light",href:"https://github.com/Squich",target:"_blank",rel:"noopener noreferrer",children:"Squich"})]})})})},z=c(0),R=function(){return Object(l.jsx)("div",{className:"container py-5-responsive",children:Object(l.jsx)("div",{className:"shadow rounded-lg overflow-hidden",children:Object(l.jsxs)(z.b.Provider,{value:{style:{verticalAlign:"middle"}},children:[Object(l.jsx)(d,{}),Object(l.jsx)("main",{className:"row px-3 py-5 bg-white",children:Object(l.jsx)("div",{className:"col",children:Object(l.jsx)(i.a,{basename:"/frigo-manager-react",children:Object(l.jsxs)(o.c,{children:[Object(l.jsx)(o.a,{exact:!0,path:"/",component:j}),Object(l.jsx)(o.a,{path:"/welcome",component:E}),Object(l.jsx)(o.a,{path:"/login",component:q}),Object(l.jsx)(o.a,{path:"/signup",component:M}),Object(l.jsx)(o.a,{path:"/forgetpassword",component:A}),Object(l.jsx)(o.a,{component:T})]})})})}),Object(l.jsx)(U,{})]})})})},L=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,63)).then((function(t){var c=t.getCLS,n=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;c(e),n(e),s(e),a(e),r(e)}))};c(57);r.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(O.Provider,{value:new x,children:Object(l.jsx)(R,{})})}),document.getElementById("root")),L()}},[[58,1,2]]]);
//# sourceMappingURL=main.ef95e9fe.chunk.js.map